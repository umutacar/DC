%==============================================================================
% Packages


\usepackage{balance}
\usepackage[latin1]{inputenc}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{stmaryrd} 
\usepackage{array}
\usepackage{url}
\usepackage{verbatim}
\usepackage{xspace}
\usepackage{mathpartir}
\usepackage{color}
\usepackage{fppdf}
%\usepackage{pst-all} 
%\usepackage{natbib}
%\usepackage{pstricks}


%==============================================================================
% Structural commands

% Comment for extra material to be saved for future use
\newenvironment {extra} {\comment} {\endcomment}

% To mark text for a particular extended version, use:
   %\newenvironment {extended} {\comment} {\endcomment}
   %\renewenvironment {extended} {} {}

% Comments between authors
\definecolor{Cquestioncolor}{rgb}{.8,.0,.0}
\newcommand{\about}[1] {\textcolor{Cquestioncolor}{{\it #1}}}
%\renewcommand {\about}[1] {} % for final version
\newcommand{\Aac}[1] {\about{AC: #1}} 

% Bicolor judgments -- todo
\definecolor {colorgrey}{rgb}{.75,.75,.75} % {.8,.8,.8}
\newcommand{\Fcol}[1] {#1}
\newcommand{\Fgrey}[1]{\colorbox{colorgrey}{$\mathstrut #1$}}   
   % to start : \renewcommand {\Fcol}[1]{\Fgrey{#1}}
   % to stop : \renewcommand {\Fcol}[1]{#1}


%==============================================================================
% Renaming of useful symbols

%******************************************************************************
% Greek alphabet   

% Lowercase
\newcommand{\Ga} {\alpha}
\newcommand{\Gb} {\beta}
\newcommand{\Gg} {\gamma}
\newcommand{\Gc} {\gamma} % c or g or y for gamma
\newcommand{\Gd} {\delta}
\newcommand{\Ge} {\epsilon}
\newcommand{\Gz} {\zeta}
\newcommand{\Gn} {\eta}  % n for eta
\newcommand{\Gh} {\theta}
\newcommand{\Gi} {\iota}
\newcommand{\Gk} {\kappa}
\newcommand{\Gl} {\lambda}
\newcommand{\Gm} {\mu}
\newcommand{\Gv} {\nu} % v for nu
\newcommand{\Gx} {\xi}
\newcommand{\Go} {o}
\newcommand{\Gp} {\pi}
\newcommand{\Gr} {\rho}
\newcommand{\Gs} {\sigma}
\newcommand{\Gy} {\varsigma} % y for varsigma
\newcommand{\Gt} {\tau}
\newcommand{\Gu} {\upsilon}
\newcommand{\Gf} {\phi}
\newcommand{\Gq} {\chi} % q for chi
\newcommand{\Gj} {\psi} % j for psi
\newcommand{\Gw} {\omega} 

% Uppercase
\newcommand{\GG} {\Gamma}
\newcommand{\GC} {\Gamma} 
\newcommand{\GD} {\Delta}
\newcommand{\GH} {\Theta} 
\newcommand{\GL} {\Lambda}
\newcommand{\GX} {\Xi}
\newcommand{\GP} {\Pi}
\newcommand{\GS} {\Sigma}
\newcommand{\GF} {\Phi}
\newcommand{\GJ} {\Psi} 
\newcommand{\GW} {\Omega} 


%******************************************************************************
% Spacing

% symmetric spacing
\newcommand{\Sc}[1] {\, #1 \,}
\newcommand{\Ss}[1] {\; #1 \;}
\newcommand{\Scs}[1] {\;\, #1 \;\,}
\newcommand{\Sq}[1] {\quad #1 \quad}
\newcommand{\Sqs}[1] {\quad\; #1 \quad\;}
\newcommand{\SQ}[1] {\qquad #1 \qquad}


%******************************************************************************
% Separators

\newcommand{\coma} {,\,}
\newcommand{\semi} {;\,}
\newcommand{\adot} {.\,}
\newcommand{\adef} {:=} 
\newcommand{\impl} {\Rightarrow}
\newcommand{\abar} {|}
\newcommand{\equal} {=}
\newcommand{\spc} {\mathstrut} %\colorbox{white}{\mathstrut}
% \equiv, \land, \approx


%******************************************************************************
% Fonts

\newcommand{\E}[1] {{\em #1}}       % definitions
\newcommand{\D}[1] {\textsc{#1}}    % name of theorems
\newcommand{\F}[1] {\textsf{#1}}    % constructor names
\newcommand{\M}[1] {\mathrm{#1}}    % math text in mathmode
\newcommand{\MI}[1] {\mathit{#1}}   % italic text in mathmode
\newcommand{\X}[1] {\textrm{#1}}    % usual text in mathmode
\newcommand{\C}[1] {{\tt #1}}       % monospace code
\newcommand{\Q}[1] {``\ensuremath{#1}''}    % formulae
\newcommand{\W}[1] {\ensuremath{#1}}    % formulae

%todo: complete

%\newcommand{\Pt}[1]{{\footnotesize #1}}
%\newcommand{\Pg}[1]{{\scriptstyle #1}}


%******************************************************************************
% Decorations

\newcommand{\Dbar}[1] {\bar{#1}} 
\newcommand{\Dangle}[1] {\langle #1 \rangle}
\newcommand{\Dbars}[1] {| #1 |}
\newcommand{\Ddbars}[1] {|| #1 ||}
\newcommand{\Dbrack}[1] {\{ #1 \}}
\newcommand{\Ddbrack}[1] {\llbracket #1 \rrbracket}
\newcommand{\Dfloor}[1] {\lfloor #1 \rfloor} 
\newcommand{\Dceil}[1] {\lceil #1 \rceil} 


%==============================================================================
% Mathematical language syntax

% Multi-lines math

\newenvironment{ands}{ \left\{\begin{array}{l} }{ \end{array}\right. }
\newenvironment{ors}{ \left|\begin{array}{l} }{ \end{array}\right. }
\newenvironment{lines}{ \begin{array}{l} }{ \end{array} }
\newenvironment{linest}{ \begin{array}[t]{l} }{ \end{array} }

% Others

\newcommand{\Odot} {\centerdot}

% Sets

\newcommand{\OSempty} {\emptyset}
\newcommand{\OSsng}[1] {\{#1\}}

\newcommand{\OSin} {\in}
\newcommand{\OSinof}[2] {#1 \Sc\OSin #2}
\newcommand{\OSnotin} {\not\in}
\newcommand{\OSnotinof}[2] {#1 \Sc\OSnotin #2}

\newcommand{\OSinc} {\subseteq}
\newcommand{\OSincof}[2] {#1 \OSinc #2}

\newcommand{\OSuni} {\cup}
\newcommand{\OSuniof}[2] {#1 \OSuni #2}
\newcommand{\OSetuniof}[2] {(\OSuniof{#1}{#2})}

\newcommand{\OSdisuni} {\uplus}
\newcommand{\OSdisuniof}[2] {#1 \OSdisuni #2}
\newcommand{\OSetdisuniof}[2] {(\OSdisuniof{#1}{#2})}

\newcommand{\OSdisuniiter}[2] {\uplus_{#1} #2} 
\newcommand{\OSetdisuniiter}[2] {(\OSdisuniiter{#1}{#2})}

\newcommand{\OSdisof}[2] {#1 \cap #2 = \OSempty} 
\newcommand{\OSrange}[3] {#1 \in #2..#3}

\newcommand{\OSrem} {\setminus}


% Maps 

\newcommand{\OMempty} {\emptyset}
\newcommand{\OMbind}{\mapsto} 
\newcommand{\OMone}[2]{[#1 \OMbind #2]}
\newcommand{\OMget}[2]{#1[#2]}
\newcommand{\OMgettwo}[3]{#1[#2][#3]}
\newcommand{\OMset}[3]{#1[#2 \OMbind #3]}
\newcommand{\OMadd}[3]{{#1}\uplus[#2 \OMbind #3]}
\newcommand{\OMdom}[1]{\mathrm{dom}(#1)}
\newcommand{\OMok}[1]{\mathrm{ok}\,#1}
\newcommand{\OMuniof}[2] {\OSuniof{#1}{#2}}

% Functions

\newcommand{\OFprod} {\times}
\newcommand{\OFprodof}[2] {{#1} \Fprod {#2}}
\newcommand{\OFsum} {+}
\newcommand{\OFsumof}[2] {{#1} \Fsum {#2}}
\newcommand{\OFcomp} {\circ}
\newcommand{\OFcompof}[2] {{#1} \Fcomp {#2}}
\newcommand{\OFid} {\F{id}}
\newcommand{\OFdot} {\bullet}

% BNF grammars

\newcommand {\grdef} {\Sq\adef}
\newcommand {\grsep} {\Sq\abar}

%==============================================================================
% Programming languages and proof syntax

% Quantifiers --todo

\newcommand{\Lforall}{\forall}
\newcommand{\Lexists}{\exists}
\newcommand{\Lforallof}[2]{\forall\,#1\adot #2}
\newcommand{\Lexistsof}[2]{\exists\,#1\adot #2}

\newcommand{\Pstate}[1] { \D{#1} }
\newcommand{\Pexi} {\exists\,}
\newcommand{\Pexiof}[1] {\Pexi #1,\,}
\newcommand{\Pfor} {\forall\,}
\newcommand{\Pforof}[1] {\Pfor #1,\,}


% Language constructors 

\newcommand{\Lwild} {\_}
\newcommand{\Lnull} {\F{null}}

\newcommand{\Ltt} {\mathit{t\!t}}
\newcommand{\Lunit} {()}
\newcommand{\Ltrue} {\F{true}}
\newcommand{\Lfalse} {\F{false}}

\newcommand{\Linj}[1] {\F{inj}^{#1}}
\newcommand{\Linjof}[2] {\Linj{#1}\,{#2}}
\newcommand{\LInjof}[2] {(\Linjof{#1}{#2})}

\newcommand{\Linl} {\F{inl}}
\newcommand{\Linlof}[1] {\Linl\,{#1}}
\newcommand{\LInlof}[1] {(\Linlof{#1})}

\newcommand{\Linr} {\F{inr}}
\newcommand{\Linrof}[1] {\Linr\,{#1}}
\newcommand{\LInrof}[1] {(\Linrof{#1})}

\newcommand{\Ltuplesep} {,}
\newcommand{\Ltuple}[1] {(#1)}
\newcommand{\Lpair}[2] {\Ltuple{#1 \Ltuplesep #2}}
\newcommand{\Ltriple}[3] {\Ltuple{#1 \Ltuplesep #2 \Ltuplesep #3}}
\newcommand{\Lquadruple}[4] {\Ltuple{#1 \Ltuplesep #2 \Ltuplesep #3 \Ltuplesep #4}}

\newcommand{\Lptuple}[1] {(|\,#1\,|)}
\newcommand{\Lppair}[2] {\Lptuple{#1 \Ltuplesep #2}}

\newcommand{\Labs}[2] {\Gl #1.\,#2}
\newcommand{\LAbs}[2] {(\Labs{#1}{#2})}

\newcommand{\Lfun}[2] {\F{fun}\, #1 \rightarrow #2}
\newcommand{\LFun}[2] {(\Lfun{#1}{#2})}

\newcommand{\Lfununit}[1] {\Lfun{\Lunit}{#1}}
\newcommand{\LFununit}[1] {(\Lfununit{#1})}

\newcommand{\Lfix}[3] {\Gm #1.\Gl #2.#3} % todo; rename into lfixof
\newcommand{\LFix}[3] {(\Lfix{#1}{#2}{#3})}

\newcommand{\Lproj}[1] {\F{proj}^{#1}}
\newcommand{\Lprojof}[2] {\Lproj{#1}\,{#2}}
\newcommand{\Lprojn}[2] {\F{proj}_{#1}^{#2}}
\newcommand{\Lprojnof}[3] {\Lprojn{#1}{#2}\,{#3}}

\newcommand{\Lapp}[2] {#1\,#2}
\newcommand{\LApp}[2] {(\Lapp{#1}{#2})}

\newcommand{\Lifthenelse}[3] {\F{if}\, #1 \,\F{then}\, #2 \,\F{else}\, #3}

\newcommand{\Llet}[2] {\F{let}\, #1 = #2 \,\F{in}\,}
\newcommand{\Lletof}[3] {\Llet{#1}{#2} #3}
\newcommand{\LLetof}[3] {(\Lletof{#1}{#2}{#3})}

\newcommand{\Lseq} {\,\semi\,}
\newcommand{\Lseqof}[2] {#1 \Lseq #2}
\newcommand{\LSeqof}[2] {(\Lseqof{#1}{#2})}

\newcommand{\Lconfig}[2] {#1 \;/\; #2}
\newcommand{\LConfig}[2] {(\Lconfig{#1}{#2})}

% Primitive functions

\newcommand{\Lref} {\F{ref}}
\newcommand{\Lrefof}[1] {\Lapp{\Lref}{#1}}
\newcommand{\LRefof}[1] {(\Lrefof{#1})}

\newcommand{\Lget} {\F{get}}
\newcommand{\Lgetof}[1] {\Lapp{\Lget}{#1}}
\newcommand{\LGetof}[1] {(\Lgetof{#1})}

\newcommand{\Lset} {\F{set}}
\newcommand{\Lsetof}[2] {\Lset\,#1\,#2}
\newcommand{\LSetof}[2] {(\Lsetof{#1}{#2})}
\newcommand{\Lsetpof}[2] {\Lapp{\Lset}{(#1,#2)}} 
\newcommand{\LSetpof}[2] {(\Lsetof{#1}{#2})}

% system functions

\newcommand{\Lfail} {\F{fail}}
\newcommand{\Ltime} {\F{get\_time}}

% Types

\newcommand{\Tbot} {\bot}
\newcommand{\Tbots} {\OLlist{\Tbot}}
\newcommand{\Ttop} {\top}
\newcommand{\Tunit} {{\F{unit}}}
\newcommand{\Tint} {\F{int}}
\newcommand{\Tfloat} {\F{float}}
\newcommand{\Tbool} {\F{bool}}
\newcommand{\Tlist} {\F{list}}
\newcommand{\Tchar} {\F{char}}
\newcommand{\Tfalse} {\F{False}}
\newcommand{\Ttrue} {\F{True}}

\newcommand{\Tsum} {+}
\newcommand{\Tsumof}[2] {#1 \Tsum #2}
\newcommand{\TSumof}[2] {(\Tsumof{#1}{#2})}

\newcommand{\Tprod} {\times}
\newcommand{\Tprodof}[2] {#1 \Tprod #2}
\newcommand{\TProdof}[2] {(\Tprodof{#1}{#2})}

\newcommand{\Tto} {\rightarrow}
\newcommand{\Ttoof}[2] {{#1}\Tto {#2}}
\newcommand{\TToof}[2] {(\Ttoof{#1}{#2})}

\newcommand{\Tref}[1] {\F{ref}\,#1}
\newcommand{\TRef}[1] {(\Tref{#1})}

\newcommand{\Trefb}[1] {#1\,\F{ref}}
\newcommand{\TRefb}[1] {(\Tref{#1})}

\newcommand{\Tarray}[1] {\F{array}\,#1}
\newcommand{\TArray}[1] {(\Tarray{#1})}

\newcommand{\Tfor}[1] {\forall #1 .}
\newcommand{\Tforof}[2] {\Tfor{#1} #2}
\newcommand{\TForof}[2] {(\Tforof{#1}{#2})}

\newcommand{\Texi}[1] {\exists #1 .}
\newcommand{\Texiof}[2] {\Texi{#1} #2}
\newcommand{\TExiof}[2] {(\Texiof{#1}{#2})}

\newcommand{\Trec}[1] {\Gm #1 .}
\newcommand{\Trecof}[2] {\Trec{#1} #2}
\newcommand{\TRecof}[2] {(\Trecof{#1}{#2})}

\newcommand{\Tstar} {*} 
\newcommand{\Tstarof}[2] {#1 \Tstar #2}
\newcommand{\TStarof}[2] {(\Tstarof{#1}{#2})}

% Environments

\newcommand{\OEfresh}[2]{#1 \mathrel{\#} #2}
\newcommand{\OEdom}[1]{\OMdom{#1}}
\newcommand{\OEnil} {\varnothing}
\newcommand{\OEsep} {,\,}
\newcommand{\OEsepof}[2] {#1 \OEsep #2}
\newcommand{\OESepof}[2] {(\OEsepof{#1}{#2})}
\newcommand{\OEtyp} {:}
\newcommand{\OEbind}[2] {#1 \OEtyp #2}
\newcommand{\OEBind}[2] {(\OEbind{#1}{#2})}
\newcommand{\OEcons}[3] {#1 \OEsep \OEbind{#2}{#3}}
\newcommand{\OECons}[3] {(\OEcons{#1}{#2}{#3})}
\newcommand{\OEitercons}[4] {\OEBind{#1}{#2}\OEsep\ldots\OEsep\OEBind{#3}{#4}}
\newcommand{\OEhas}[3] {\OSinof{\OEbind{#1}{#2}}{#3}}

% Functions on terms

\newcommand{\Ofv}[1] {\mathrm{fv}(#1)}
\newcommand{\Osubstop}[2] {[#1 \to #2]} 
\newcommand{\Osubst}[3] {[#1 \to #2]\,#3} 
\newcommand{\OSubst}[3] {(\Osubst{#1}{#2}{#3})}
\newcommand{\Osubsttwo}[5] {[#1 \to #2][#3 \to #4]\,#5} 
\newcommand{\OSubsttwo}[5] {\Osubsttwo{#1}{#2}{#3}{#4}{#5}} 
\newcommand{\Osubstiter}[4] { \Osubst{#1}{#2}{}\ldots\Osubst{#3}{#4}{} }

% Reductions

\newcommand{\Jredindone}[1] {\longrightarrow_{#1}}
\newcommand{\Jredindoneof}[3] {#2 \Jredindone{#1} #3}
\newcommand{\Jredone} {\longrightarrow}
\newcommand{\Jredoneof}[2] {#1 \Jredone #2}
\newcommand{\Jredplus} {\Jredone^+}
\newcommand{\Jredplusof}[2] {#1 \Jredplus #2}
\newcommand{\Jredstar} {\Jredone^*}
\newcommand{\Jredstarof}[2] {#1 \Jredstar #2}
\newcommand{\Jredinf} {\Jredone^\infty}
\newcommand{\Jrednot} {\;\;\;{\not{\!\!\!\!{\longmapsto}}}\;}
\newcommand{\Jrednotof}[1] {#1 \Jrednot}
\newcommand{\Jreddiv} {\Uparrow}
\newcommand{\Jreddivof}[1] { #1 \Jreddiv}
\newcommand{\Jredbig} {\Downarrow}
\newcommand{\Jredbigof}[2] {#1 \Jredbig #2}


% Typing symbols

\newcommand{\Jtyp} {\Sc{:}}
\newcommand{\Jtypof}[2] {#1 : #2}
\newcommand{\JTypof}[2] {(\Jtypof{#1}{#2})}
\newcommand{\Jdef} {:=}
\newcommand{\Jthesis} {\Sc\vdash}
\newcommand{\Jthesisind}[1] {\Sc\vdash_{#1}}
\newcommand{\Jdbthesis} {\Sc\Vdash}
\newcommand{\Jdbthesisind}[1] {\Sc\Vdash_{#1}}
\newcommand{\Jmodels} {\Sc\models}
\newcommand{\Jtrans} {\Sc\vartriangleright}
\newcommand{\Jtransb} {\Sc\blacktriangleright}
\newcommand{\Jsub} {\Sc\leq}
\newcommand{\Jconv} {\Sc\equiv}
\newcommand{\Jtyping}[3] { {#1} \Jthesis {#2} \Jtyp {#3}}


%==============================================================================
%==============================================================================
% Formatting

% Dense list of points
\newenvironment{ul}
{ \begin{list}
        {$-$}
        {%\setlength{\labelwidth}{30pt}
         \addtolength{\leftmargin}{-3pt}
         \addtolength{\topsep}{- \parskip}
         %\setlength{\topsep}{- \parskip}
         %\addtolength{\topsep}{7pt}
         %\addtolength{\bottomsep}{3pt}
         \setlength{\itemsep}{2pt}
    }}
{ \end{list} \vspace*{5pt} }

% Even denser list of points
\newenvironment{uldense}
{ \begin{list}
        {$-$}
        {%\setlength{\labelwidth}{30pt}
         \addtolength{\leftmargin}{-3pt}
         \addtolength{\topsep}{- \parskip}
         %\setlength{\topsep}{- \parskip}
         %\addtolength{\topsep}{7pt}
         %\addtolength{\bottomsep}{3pt}
         \setlength{\itemsep}{0pt}
    }}
{ \end{list} }

%\newenvironment{boxedtext} 
%   {\begin{center}\begin{tabular}{|p{10cm}|}\hline}
%   {\vspace{2pt}\\ \hline\end{tabular}\end{center}}

\newenvironment{num}{}{}
\newcommand{\numitem}{}


%==============================================================================
%==============================================================================
% Generic

%******************************************************************************
% Common text

\newcommand{\lc}{$\lambda$-calculus\xspace}
\newcommand{\stlc}{simply-typed $\lambda$-calculus\xspace}
\newcommand{\la}{$\lambda$-abstraction\xspace}
\newcommand{\las}{$\lambda$-abstractions\xspace}
\newcommand{\lt}{$\lambda$-term\xspace}
\newcommand{\lts}{$\lambda$-terms\xspace}
\newcommand{\brx}{$\beta$-redex\xspace}
\newcommand{\br}{$\beta$-reduction\xspace}
\newcommand{\bre}{$\beta$-reduce\xspace}
\newcommand{\aeqc}{$\alpha$-equivalence\xspace}
\newcommand{\acv}{$\alpha$-conversion\xspace}
\newcommand{\aeqt}{$\alpha$-equivalent\xspace}
\newcommand{\arn}{$\alpha$-rename\xspace}
\newcommand{\lv}{online addendum~\cite{addendum}\xspace}


%******************************************************************************
% Proofs

\begin{comment}
\newcommand{\Plabcase}[2] {\vspace*{10pt} $\blacktriangleright$ {\it {#1}: {#2}}\vspace*{5pt} }
\newcommand{\Plabsubcase}[2] {\vspace*{10pt} \hspace{0.5cm} $\star$ {\it {#1}: {#2}}\vspace*{5pt} }
\newcommand{\Plabsubsubcase}[2] {\vspace*{10pt} \hspace{1.0cm} $\circ$ {\it {#1}: {#2}} \vspace*{5pt}}

\newcommand{\Pcase}[1] { \Plabcase{Case}{#1} }
\newcommand{\Psubcase}[1] { \Plabsubcase{Sub-case}{#1} }
\newcommand{\Psubsubcase}[1] { \Plabsubsubcase{Sub-sub-case}{#1} }

\newcommand{\Pcases}[1] { \Plabcase{Cases}{#1} }
\newcommand{\Psubcases}[1] { \Plabsubcase{Sub-cases}{#1} }
\newcommand{\Psubsubcases}[1] { \Plabsubsubcase{Sub-sub-cases}{#1} }
\end{comment}

\newcommand{\Pcase} {$\bullet$ Case }


%******************************************************************************
%******************************************************************************
% References

\newcommand{\sref}[1]{\S\ref{#1}}
\newcommand{\tref}[1]{Theorem~\ref{#1}}
\newcommand{\dref}[1]{Definition~\ref{#1}}
\newcommand{\eref}[1]{Example~\ref{#1}}
\newcommand{\fref}[1]{Figure~\ref{#1}}
\newcommand{\cref}[1]{Claim~\ref{#1}}

\newcommand{\citey}[1]{[\citeyear{#1}]}


%******************************************************************************
%******************************************************************************
% Theorems

\usepackage{ntheorem}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}{Lemma}[section]
\newtheorem{example}{Example}[section]
\newtheorem{definition}{Definition}[section]
\newtheorem{corollary}{Corollary}[section]
%\newtheorem{proof}{Proof}

\newenvironment{proof}[1][Proof]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}

\newcommand{\qed}{\ensuremath{\Box}}


%==============================================================================
%==============================================================================
% Local style

% To sort

\newcommand{\Fmod} {\Ga}
\newcommand{\Fmodpar} {\F{orc}}
\newcommand{\Fmodseq} {\F{seq}}
\newcommand{\Fcomp}[2] {\Ddbrack{#2}^{#1}}
\newcommand{\Fcompga}[1]{\Fcomp{\Ga}{#1}}
\newcommand{\Fcompval}[1]{\Fcomp{}{#1}} % {\langle{#1} \rangle} %{\Fcomp{}{#1}}

\newcommand{\Lfuncost}[4] {\F{fun}\, #1 \rightarrow_{#2}^{#3} #4}
\newcommand{\LFuncost}[4] {(\fun{#1}{#2}{#3}{#4})}

\newcommand{\Fschedule}{\mathit{Schedule\_parallel}}
\newcommand{\Fscheduleof}[2]{\Fschedule(#1,#2)}

\newcommand{\Fcutoff}{\F{cutoff}}
\newcommand{\Fminworktiming}{\F{min\_work\_for\_timing}}
\newcommand{\Freport}{\F{exec\_and\_report}}
\newcommand{\fskip}{\vspace{4pt} \\}

\newcommand{\Lcostfunction} {\F{cost\_function}}
\newcommand{\Lcostfunctionof}[1] {\Lcostfunction\,#1}
\newcommand{\Lseqversion} {\F{seq\_version}}
\newcommand{\Lseqversionof}[1] {\Lseqversion\,#1}
\newcommand{\Lparversion} {\F{par\_version}}
\newcommand{\Lparversionof}[1] {\Lparversion\,#1}


\newcommand{\floorfrac}[2]{\floor{\frac{#1}{#2}}}
\newcommand{\kpos}[1]{ {#1}^{+}} %\right( #1 \left)
\newcommand{\kposOf}[1]{ { \left(#1\right) }^{+}} %\right( #1 \left)
\newcommand{\floorfracposn}[2]{\floor{\frac{\kposOf{#1}}{#2}}}

%
\newcommand{\sseq}{\F{seq}}
\newcommand{\sorc}{\F{orc}}
\newcommand{\spar}{\F{par}}

%deprecated:
\newcommand{\reda}{\Downarrow^\alpha}
\newcommand{\redas}{\Downarrow^{[\sseq/\alpha]\alpha}}
\newcommand{\redao}{\Downarrow^{[\sorc/\alpha]\alpha}}
\newcommand{\reds}{\Downarrow^{std}}
\newcommand{\redo}{\Downarrow^{orc}}
\newcommand{\redb}{\Downarrow}

\newcommand{\Jcostof}[7] {#2 \Downarrow^{#1} #3, (#4,#5), (#6,#7)}
\newcommand{\Jtime}[2] {T^{#1}_{#2}}
\newcommand{\Jtimeseq} {\Jtime{\sseq}{}}
\newcommand{\Jtimeorc}[1] {\Jtime{\sorc}{#1}}
\newcommand{\Jtimepar}[1] {\Jtime{\spar}{#1}}

\newcommand{\Jsemof}[2] {#1 \Downarrow #2}

\newcommand{\PL}[1]{\Dbars{#1}}
\newcommand{\PN}[1]{\Ddbars{#1}}
\newcommand{\PW}[1]{\Ddbars{#1}}
\newcommand{\mysum}[4]{\sum_{#1=#2}^{#3}\,#4}
\newcommand{\mymax}[2]{\X{max}_{#1}\,#2}
\newcommand{\myint}[2]{[#1,#2]}

\newcommand{\Tced}{\F{ced}}

%todo: use a macro for substitution
%todo: rename kappa into a macro

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% mac.tex
%%
%% Umut A. Acar
%% Macros for adaptive computation paper.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\isel}{\textsf{ISEL}\xspace}

\newcommand{\readarrow}{\ensuremath{\Longrightarrow}}


\newcommand{\cutspace}{\vspace{-4mm}}

\newcommand{\bomb}[1]{\fbox{\mbox{\emph{\bf {#1}}}}}

% \renewcommand{\paragraph}[1]{{\bf {#1}}}
% formatting stuff
\newcommand{\codecolsep}{1ex}

%\newcommand{\todo}[1]{{\bf{[NOTE:{#1}]}}}
%\newcommand{\todo}[1]{}

\newcommand{\tablerow}{\\[5ex]}
\newcommand{\tableroww}{\\[7ex]}
\newcommand{\tableline}{
\vspace*{2ex}\\
\hline\\ 
\vspace*{2ex}}

% Don't care
\newcommand{\dontcare}{\_}


%% filter and quicksort stuff
\newcommand{\ncf}[2]{C^{fil}_{\ensuremath{{#1},{#2}}}}
\newcommand{\ncq}[1]{C^{qsort}_{\ensuremath{#1}}}
\newcommand{\nuf}[3]{P^{fil}_{#1,(\ensuremath{{#2},{#3}})}}
\newcommand{\nuq}[2]{P^{qsort}_{(\ensuremath{{#1},{#2}})}}

%% shorthands
\newcommand{\ttt}[1]{\texttt{#1}}


\newcommand{\ddg}{{\sc ddg}\xspace}
\newcommand{\ncpa}{change-propagation algorithm}
\newcommand{\adg}{{\sc adg}}
\newcommand{\nwrite}{\texttt{write}\xspace}
\newcommand{\nread}{\texttt{read}\xspace}
\newcommand{\nmodr}{\texttt{mod}\xspace}
\newcommand{\nnewmodr}{\texttt{newMod}\xspace}
\newcommand{\nmodl}{\texttt{modl}\xspace}
\newcommand{\nmemo}{\texttt{memo}\xspace}
\newcommand{\nhash}{\texttt{\#}\xspace}
\newcommand{\nnil}{\ttt{NIL}\xspace}
\newcommand{\ncons}[2]{\ttt{CONS({\ensuremath{#1},\ensuremath{#2}})}\xspace}
\newcommand{\nfilter}{\texttt{filter}\xspace}
\newcommand{\nfilterp}{\texttt{filter'}\xspace}
\newcommand{\naqsort}{\texttt{qsort'}\xspace}
\newcommand{\nqsort}{\texttt{qsort}}
\newcommand{\nqsortp}{\texttt{qsort'}}
\newcommand{\nnewMod}{\texttt{newMod}\xspace}
\newcommand{\nhashmodr}{\texttt{hashMod}\xspace}
\newcommand{\nchange}{\texttt{change}\xspace}
\newcommand{\nderef}{\texttt{deref}\xspace}
\newcommand{\npropagate}{\texttt{propagate}\xspace}
\newcommand{\ndest}{\texttt{d}\xspace}
\newcommand{\ninit}{\texttt{init}\xspace}



%% Comment sth out. 
\newcommand{\out}[1] {}
\newcommand{\sthat}{\ensuremath{~|~}}

%% definitions
\newcommand{\defi}[1]{{\bfseries\itshape #1}}


% Code listings.
\newcounter{codeLineCntr}
\newcommand{\codeLine}
 {\refstepcounter{codeLineCntr}{\thecodeLineCntr}}
\newcommand{\codeLineL}[1]
 {\refstepcounter{codeLineCntr}\label{#1}{\thecodeLineCntr}}

\newenvironment{codeListing}
 {\setcounter{codeLineCntr}{0}
%  \fontsize{10}{12}
 % the first one is width the second is height
% \fontsize{8}{8}
%  \vspace{-.1in}
  \ttfamily\begin{tabbing}}
  {\end{tabbing}
%   \vspace{-.1in}
}

\newenvironment{codeListing8}
 {\setcounter{codeLineCntr}{0}
  \fontsize{8}{10}
  \vspace{-.1in}
  \ttfamily
  \begin{tabbing}}
 {\end{tabbing}
 \vspace{-.1in}
}

\newenvironment{codeListing8h}
 {\setcounter{codeLineCntr}{0}
  \fontsize{8.5}{10.5}
  \vspace{-.1in}
  \ttfamily
  \begin{tabbing}}
 {\end{tabbing}
 \vspace{-.1in}
}


\newenvironment{codeListing9}
 {\setcounter{codeLineCntr}{0}
  \fontsize{9}{11}
  \vspace{-.1in}
  \ttfamily
  \begin{tabbing}}
 {\end{tabbing}
 \vspace{-.1in}
}

\newenvironment{codeListing10}
 {\setcounter{codeLineCntr}{0}
  \fontsize{10}{12}
  \vspace{-.1in}
  \ttfamily
  \begin{tabbing}}
 {\end{tabbing}
 \vspace{-.1in}
}


\newenvironment{codeListingNormal}
 {\setcounter{codeLineCntr}{0}
  \vspace{-.1in}
  \ttfamily
  \begin{tabbing}}
 {\end{tabbing}
 \vspace{-.1in}
}

\newcommand{\codeFrame}[1]
{\begin{center}\fbox{\parbox[t]{5in}{#1}}\end{center}
% \vspace*{-.15in}
}

\newcommand{\fixedCodeFrame}[1]
{
\vspace*{-4mm}
\begin{center}
\fbox{
\vspace*{-2mm}
\parbox[t]{0.999\columnwidth}{
\vspace*{-2mm}
#1
}
}\end{center}
\vspace*{-4mm}
}

% Footnote commands.
\newcommand{\footnotenonumber}[1]{{\def\thempfn{}\footnotetext{#1}}}

% Margin notes - use \notesfalse to turn off notes.
\setlength{\marginparwidth}{0.6in}
\reversemarginpar
\newif\ifnotes
\notestrue
\newcommand{\longnote}[1]{
  \ifnotes
    {\medskip\noindent Note:\marginpar[\hfill$\Longrightarrow$]
      {$\Longleftarrow$}{#1}\medskip}
  \fi}
\newcommand{\note}[1]{
  \ifnotes
    {\marginpar{\raggedright{\tiny #1}}}
  \fi}

% Stuff not wanted.
\newcommand{\punt}[1]{}

% Sectioning commands.
\newcommand{\subsec}[1]{\subsection{\boldmath #1 \unboldmath}}
\newcommand{\subheading}[1]{\subsubsection*{#1}}
\newcommand{\subsubheading}[1]{\paragraph*{#1}}

% Reference shorthands.
\newcommand{\spref}[1]{Modified-Store Property~\ref{sp:#1}}
\newcommand{\prefs}[2]{Properties~\ref{p:#1} and~\ref{p:#2}}
\newcommand{\pref}[1]{Property~\ref{p:#1}}


\newcommand{\partref}[1]{Part~\ref{part:#1}}
\newcommand{\chref}[1]{Chapter~\ref{ch:#1}}
\newcommand{\chreftwo}[2]{Chapters \ref{ch:#1} and~\ref{ch:#2}}
\newcommand{\chrefthree}[3]{Chapters \ref{ch:#1}, and~\ref{ch:#2}, and~\ref{ch:#3}}
\newcommand{\secref}[1]{Section~\ref{sec:#1}}
\newcommand{\subsecref}[1]{Subsection~\ref{subsec:#1}}
\newcommand{\secreftwo}[2]{Sections \ref{sec:#1} and~\ref{sec:#2}}
\newcommand{\secrefthree}[3]{Sections \ref{sec:#1},~\ref{sec:#2},~and~\ref{sec:#3}}
\newcommand{\appref}[1]{Appendix~\ref{app:#1}}
\newcommand{\figref}[1]{Figure~\ref{fig:#1}}
\newcommand{\figreftwo}[2]{Figures \ref{fig:#1} and~\ref{fig:#2}}
\newcommand{\figpageref}[1]{page~\pageref{fig:#1}}
\newcommand{\tabref}[1]{Table~\ref{tab:#1}}
\newcommand{\stref}[1]{step~\ref{step:#1}}
\newcommand{\caseref}[1]{case~\ref{case:#1}}
\newcommand{\lineref}[1]{line~\ref{line:#1}}
\newcommand{\linereftwo}[2]{lines \ref{line:#1} and~\ref{line:#2}}
\newcommand{\linerefthree}[3]{lines \ref{line:#1},~\ref{line:#2},~and~\ref{line:#3}}
\newcommand{\linerefrange}[2]{lines \ref{line:#1} through~\ref{line:#2}}
\newcommand{\thmref}[1]{Theorem~\ref{thm:#1}}
\newcommand{\thmreftwo}[2]{Theorems \ref{thm:#1} and~\ref{thm:#2}}
\newcommand{\thmpageref}[1]{page~\pageref{thm:#1}}
\newcommand{\lemref}[1]{Lemma~\ref{lem:#1}}
\newcommand{\lemreftwo}[2]{Lemmas \ref{lem:#1} and~\ref{lem:#2}}
\newcommand{\lemrefthree}[3]{Lemmas \ref{lem:#1},~\ref{lem:#2},~and~\ref{lem:#3}}
\newcommand{\lempageref}[1]{page~\pageref{lem:#1}}
\newcommand{\corref}[1]{Corollary~\ref{cor:#1}}
\newcommand{\defref}[1]{Definition~\ref{def:#1}}
\newcommand{\defreftwo}[2]{Definitions \ref{def:#1} and~\ref{def:#2}}
\newcommand{\defpageref}[1]{page~\pageref{def:#1}}
%\newcommand{\eqref}[1]{Equation~(\ref{eq:#1})}
\newcommand{\eqreftwo}[2]{Equations (\ref{eq:#1}) and~(\ref{eq:#2})}
\newcommand{\eqpageref}[1]{page~\pageref{eq:#1}}
\newcommand{\ineqref}[1]{Inequality~(\ref{ineq:#1})}
\newcommand{\ineqreftwo}[2]{Inequalities (\ref{ineq:#1}) and~(\ref{ineq:#2})}
\newcommand{\ineqpageref}[1]{page~\pageref{ineq:#1}}
\newcommand{\itemref}[1]{Item~\ref{item:#1}}
\newcommand{\itemreftwo}[2]{Item~\ref{item:#1} and~\ref{item:#2}}

% Useful shorthands.
\newcommand{\abs}[1]{\left| #1\right|}
\newcommand{\card}[1]{\left| #1\right|}
\newcommand{\norm}[1]{\left\| #1\right\|}
\newcommand{\floor}[1]{\left\lfloor #1 \right\rfloor}
\newcommand{\ceil}[1]{\left\lceil #1 \right\rceil}
  \renewcommand{\choose}[2]{{{#1}\atopwithdelims(){#2}}}
\newcommand{\ang}[1]{\langle#1\rangle}
\newcommand{\paren}[1]{\left(#1\right)}
\newcommand{\prob}[1]{\Pr\left\{ #1 \right\}}
\newcommand{\expect}[1]{\mathrm{E}\left[ #1 \right]}
\newcommand{\expectsq}[1]{\mathrm{E}^2\left[ #1 \right]}
\newcommand{\variance}[1]{\mathrm{Var}\left[ #1 \right]}
\newcommand{\twodots}{\mathinner{\ldotp\ldotp}}

% Standard number sets.
\newcommand{\reals}{{\mathrm{I}\!\mathrm{R}}}
\newcommand{\integers}{\mathbf{Z}}
\newcommand{\naturals}{{\mathrm{I}\!\mathrm{N}}}
\newcommand{\rationals}{\mathbf{Q}}
\newcommand{\complex}{\mathbf{C}}

% Special styles.
\newcommand{\proc}[1]{\ifmmode\mbox{\textsc{#1}}\else\textsc{#1}\fi}
\newcommand{\procdecl}[1]{
  \proc{#1}\vrule width0pt height0pt depth 7pt \relax}
  \newcommand{\func}[1]{\ifmmode\mathrm{#1}\else\textrm{#1}fi} %
%  Multiple cases.  
\renewcommand{\cases}[1]{\left\{
  \begin{array}{ll}#1\end{array}\right.}
  \newcommand{\cif}[1]{\mbox{if $#1$}} 

%% spacing hacks
\newcommand{\longpage}{\enlargethispage{\baselineskip}}
\newcommand{\shortpage}{\enlargethispage{-\baselineskip}}

